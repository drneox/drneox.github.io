<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>infección de routers de movistar | Carlos Ganoza</title>
  <meta name="description" content="drneox@root-karina:~$" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />

  <meta name="generator" content="Carlos Ganoza">

  
  
  

  
</head>


<body class="post-template">

  

<main class="content" role="main">
  <article class="post">
    <header class="post-header">
      <a class="blog-logo" href="/">
        
        <span class="blog-title">Carlos Ganoza</span>
        
      </a>
    </header>
    <span class="post-meta">
      <time datetime="2014-04-04T02:00:00.000Z" itemprop="datePublished">04 Apr, 2014</time>
      
    </span>
    <h1 class="post-title">infección de routers de movistar</h1>
    <section class="post-content">
      <p>El otro día me pasó algo muy curioso, luego de recoger mi smartphone de servicio técnico de claro me percaté que no podía acceder a internet mediante wifi (hacer uso de las apps de facebook y gmail para ser mas exacto), al principió creí que era mi router que estaba fallando, pero luego al intentar conectarme desde mi laptop no tenía problemas, al insistir un poco mas intentando entrar a google me apareció esto:</p>
<p><img src="https://lh4.googleusercontent.com/-RZXhXg2x550/U0N-MUnt80I/AAAAAAAADjY/Mz17Fr9Igrs/w284-h504-no/Screenshot_2014-04-07-22-33-35.png"><br><img src="https://lh3.googleusercontent.com/-nFvBrr3CHo0/U0N-i-ou1JI/AAAAAAAADjg/kGETEfH1R-c/w284-h504-no/Screenshot_2014-04-07-22-33-59.png"></p>
<p>me pareció muy extraño y me puse a revisar la configuración avanzada del wifi y me topé con esta DNS extraña configurada en mi dispositivo:</p>
<p><img src="https://lh6.googleusercontent.com/-D3cOJJikNzE/U0N_-pcfOvI/AAAAAAAADkE/gvSxoSI7QH0/w706-h504-no/IMG_20140407_234946.jpg"></p>
<p>me asusté y luego del ataque de panico cambié las DNS por las de google y me puse a pensar en que pudo haber pasado, quizás en el soporte técnico me habían cambiado las DNS?, algún malware entro a mi smartphone?.</p>
<p>Luego me dispuse a “googlear” dicha IP, cuando OH SORPRESA! me aparece lo mismo en el navegador de mi laptop WDF!!! si yo uso linux, es imposible que me infecte!!! si linux es el sistema mas mejor del mundo mundial!! [si eres talibán y usas arch o similares no leas esto]mi distro es ubuntu para ser mas exacto [/si eres talibán y usas arch o similares no leas esto].</p>
<p>Esta supuesta actualización de flash player en realidad descargaba un malware que es detectado por la mayoría de antivirus:</p>
<p>link del análisis de virus total: <a href="https://www.virustotal.com/en/file/cc0c03e84df0359dde1871ee1ace38967663973bde3ade4b94174c232b18b6c3/analysis/" target="_blank" rel="external">https://www.virustotal.com/en/file/cc0c03e84df0359dde1871ee1ace38967663973bde3ade4b94174c232b18b6c3/analysis/</a></p>
<p>entonces era evidente, habían comprometido mi router, esto lo pude comprobar luego de revisar la configuuración del mismo (un billion bipac 5200 que ya pasó a mejor vida).</p>
<p>Todo esto me hizo acordar a mi charla del limahack 2011 routers: contraseñas por defecto donde yo mismo decía cuidado con usar DHCP!!…y no lo puse en practica esta vez fail.</p>
<p>Pero al no usar las credenciales por defecto para ingresar a la configuración de mi router era obvio que este tenía una vulnerabilidad, y me lo confirmó el amigo Alguien, quien hasta un exploit había escrito para esta, luego de concluir que yo era el ultimo en enterarme de la vulnerabilidad y que el que me hackeó fue Alguien XD me entero que lo mio no fue un caso aislado, pues según la prensa local veo que muchos usuarios han reportado problemas similares anteriormente: <a href="http://www.larepublica.pe/06-01-2014/usuarios-reportan-fallas-en-internet-de-movistar-peru" target="_blank" rel="external">http://www.larepublica.pe/06-01-2014/usuarios-reportan-fallas-en-internet-de-movistar-peru</a></p>
<p>donde según el experto la solución momentánea está en reiniciar el router y estarás protegido unos 3 días aproximadamente LOL , apuesto a que te hizo acordar al soporte técnico de movistar no???? nooooo??????.</p>
<p>En conclusión habían estado re-dirigiendo mi trafico a un portal malicioso para que yo descargara malware, y quien sabe si probablemente eh puesto mis credenciales en portales falsos (redes sociales, correos electrónicos y cuentas bancarias de miles de millones de dolares?) resueltos maliciosamente por las DNS del atacante, pues todas las resoluciones de IP han pasado por su servidor (ya cambie todas mis contraseñas y de router!)</p>
<p>Pues solo puedo recomendar que tengan cuidado con su router, tengan actualizada la ultima versión del firmware y no usen DHCP, o por lo menos configuren las DNS manualmente en sus dispositivos.</p>
<p>Tienes alguna otra sugerencia ?</p>

    </section>
      <section id="comment">
          <h1 class="title">Comments</h1>

          
          <div id="disqus_thread">
              <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          </div>
          
      </section>
    <footer class="post-footer">
      <section class="author">
        <h4>Carlos Ganoza</h4>
        <p>A padawan software engineer. I like python, ruby, js, open hardware and the salchipapas</p>
      </section>

      <section class="share">
        <h4>Share this post</h4>
        <a class="icon-twitter" href="http://twitter.com/share?url=http://blog.carlosganoza.com/2014/04/04/infeccion-de-routers-de-movistar/"
          onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <span class="hidden">Twitter</span>
        </a>
        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.carlosganoza.com/2014/04/04/infeccion-de-routers-de-movistar/"
          onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <span class="hidden">Facebook</span>
        </a>
        <a class="icon-google-plus" href="https://plus.google.com/share?url=http://blog.carlosganoza.com/2014/04/04/infeccion-de-routers-de-movistar/"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
          <span class="hidden">Google+</span>
        </a>
      </section>
    </footer>
  </article>
</main>


  
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Carlos Ganoza</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>


<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-77952548-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>


<script type="text/javascript">
    var disqus_shortname = 'carlosganoza';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




</body>
</html>
